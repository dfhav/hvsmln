<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strategic Full Funnel Budget Allocator</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:'Inter',Arial,sans-serif;background:linear-gradient(135deg,#0f172a,#1e293b);margin:0;padding:30px}
.container{max-width:1250px;margin:auto;background:#ffffff;padding:35px;border-radius:20px;box-shadow:0 25px 60px rgba(0,0,0,0.25)}
h1{margin:0 0 5px 0;font-size:26px}
.subtitle{color:#64748b;margin-bottom:25px}
.section-title{font-weight:600;margin-bottom:10px;font-size:13px;text-transform:uppercase;color:#475569}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:30px}
label{font-size:12px;font-weight:600;color:#334155;margin-top:10px;display:block}
select,input{width:100%;padding:9px;margin-top:5px;border-radius:8px;border:1px solid #cbd5e1;background:#f8fafc}
button{margin-top:20px;padding:12px;border:none;border-radius:10px;background:#0f172a;color:white;font-weight:600;cursor:pointer}
button:hover{background:#1e293b}
.info-btn{margin-left:8px;padding:2px 8px;border-radius:50%;background:#334155;color:white;font-size:11px;cursor:pointer}
.results{margin-top:35px;display:grid;grid-template-columns:repeat(3,1fr);gap:20px}
.card{background:#f1f5f9;padding:18px;border-radius:16px;text-align:center}
.card h3{margin:0;font-size:13px;color:#475569}
.card p{font-size:20px;font-weight:700;margin:8px 0}
#chart{width:50% !important;max-width:400px;margin:auto;margin-top:30px}
.matrix{margin-top:35px;padding:20px;background:#eef2f7;border-radius:14px;font-size:14px}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.6);justify-content:center;align-items:center}
.modal-content{background:white;padding:25px;border-radius:12px;max-width:500px}
.close{float:right;cursor:pointer;font-weight:bold}
.target-info{font-size:12px;color:#64748b;margin-top:3px}
</style>
</head>
<body>
<div class="container">
<h1>Strategic Full Funnel Budget Allocator</h1>
<p class="subtitle">Budget Allocation Optimization under Diminishing Returns</p>
<p class="subtitle">Scenario planning dinamico per Target vs Total Market</p>

<div class="grid">
<div>
<div class="section-title">Brand & Market Variables</div>

<label>Categoria</label>
<select id="category">
<option>All categories</option>
<option>Automotive</option>
<option>FMCG</option>
<option>Finance</option>
<option>Retail Large</option>
<option>Retail Small</option>
<option>Telco</option>
<option>Travel</option>
</select>

<label>Market Type</label>
<select id="marketType">
<option>Mass Market</option>
<option>Niche</option>
<option>Not Applicable</option>
</select>

<label>Market Size (€ milioni)</label>
<input type="number" id="marketSize" value="500">

<label>Target (opzionale)</label>
<select id="target" onchange="updateTargetInfo()">
<option value="">Nessun target specifico (Total Market)</option>
</select>
<div class="target-info" id="targetUniverse"></div>

</div>

<div>
<div class="section-title">Investment Strategy</div>

<label>Annual Media Spend (€ milioni)</label>
<input type="number" id="spend" value="20">

<label>Optimisation Time-frame</label>
<select id="timeframe">
<option>Short term</option>
<option>Medium term</option>
<option>Long term</option>
</select>

<button onclick="calculate()">Run Simulation</button>
</div>
</div>

<div class="results" id="results"></div>
<canvas id="chart"></canvas>
<div class="matrix" id="matrix"></div>

</div>

<div class="modal" id="modal">
<div class="modal-content">
<span class="close" onclick="closeModal()">X</span>
<div id="modalText"></div>
</div>
</div>

<script>

const targets = {

"Target Entità Individui":{size:52238950,type:"balanced"},
"Adu 25-54":{size:23383730,type:"balanced"},
"Adu 18-34":{size:10458850,type:"digital-heavy"},
"RA":{size:25570960,type:"balanced"},
"Adu 35-54":{size:17034800,type:"balanced"},
"Adu 25-64":{size:31970760,type:"balanced"},
"Adu Over64":{size:13882540,type:"traditional"},
"Adu Over18":{size:49786916,type:"balanced"},
"Adu 18-24":{size:4010306,type:"digital-heavy"},
"Adu 25-34":{size:6271725,type:"digital-heavy"},
"Adu 35-44":{size:7491822,type:"balanced"},
"Adu 35-64":{size:25621840,type:"balanced"},
"Adu 45-54":{size:9510176,type:"balanced"},
"Adu 55-64":{size:8570061,type:"traditional"},
"Adu Over35":{size:39823304,type:"balanced"},
"Adu 20-54":{size:26374360,type:"balanced"},
"Adu 18-64":{size:35856000,type:"balanced"},
"Donne 18-64":{size:18067830,type:"balanced"},
"GEN Z (14-29)":{size:9463985,type:"digital-heavy"},
"Donne 18-34":{size:5074900,type:"digital-heavy"},
"Donne 18-44":{size:8835440,type:"balanced"},
"Donne 18-54":{size:13357340,type:"balanced"},
"Donne 25-44":{size:6670890,type:"balanced"},
"Donne 25-54":{size:11417750,type:"balanced"},
"Uomini 18-64":{size:18012860,type:"balanced"},
"MILLENIALS (29 – 44)":{size:11291260,type:"balanced"},
"GEN X (45 – 60)":{size:15122390,type:"balanced"},
"BOOMERS (61 – 70)":{size:10560170,type:"traditional"}

};

const targetSelect=document.getElementById("target");
for(let t in targets){
let opt=document.createElement("option");
opt.value=t;
opt.text=t;
targetSelect.appendChild(opt);
}

function updateTargetInfo(){
let t=document.getElementById("target").value;
if(t===""){
 document.getElementById("targetUniverse").innerHTML="";
}else{
 document.getElementById("targetUniverse").innerHTML="Universe: "+targets[t].size.toLocaleString();
}
}

function calculate(){

let spend=parseFloat(document.getElementById("spend").value);
let marketSize=parseFloat(document.getElementById("marketSize").value);
let timeframe=document.getElementById("timeframe").value;
let selectedTarget=document.getElementById("target").value;

let upper=45,mid=30,lower=25;

if(timeframe==="Short term"){upper-=10;lower+=10}
if(timeframe==="Long term"){upper+=10;lower-=10}

if(selectedTarget!==""){
 let profile=targets[selectedTarget].type;
 if(profile==="digital-heavy"){lower+=10;upper-=5;mid-=5;}
 if(profile==="traditional"){upper+=10;lower-=5;mid-=5;}
}

let sat=Math.log(spend+1);
upper+=sat*2;
lower-=sat*2;

let total=upper+mid+lower;
upper=Math.round((upper/total)*100);
mid=Math.round((mid/total)*100);
lower=100-upper-mid;

let sov=(spend/marketSize)*100;
let bfRatio=((upper+mid)/lower).toFixed(2);
let esov=(sov-10).toFixed(2);

results.innerHTML=
`<div class="card"><h3>Upper (Brand)</h3><p>${upper}%</p></div>
<div class="card"><h3>Mid</h3><p>${mid}%</p></div>
<div class="card"><h3>Lower (Activation)</h3><p>${lower}%</p></div>`;

renderChart(upper,mid,lower);

matrix.innerHTML=`
<strong>Binet & Field Ratio</strong> ${bfRatio}:1 <span class="info-btn" onclick="openModal('bf')">i</span><br><br>
<strong>Share of Voice stimata</strong> ${sov.toFixed(2)}% <span class="info-btn" onclick="openModal('sov')">i</span><br><br>
<strong>Excess Share of Voice (ESOV)</strong> ${esov}% <span class="info-btn" onclick="openModal('esov')">i</span>`;

}

function openModal(type){
let text="";
if(type==='bf')text="La Binet & Field Ratio misura l'equilibrio tra Brand building e Activation. Strategie di crescita sostenibile tendono verso 60:40 o 2:1.";
if(type==='sov')text="La Share of Voice indica la quota investimento del brand rispetto al totale mercato pubblicitario.";
if(type==='esov')text="L'Excess Share of Voice è la differenza tra SOV e quota di mercato. ESOV positivo è correlato a crescita futura.";
document.getElementById('modalText').innerHTML=text;
document.getElementById('modal').style.display='flex';
}
function closeModal(){document.getElementById('modal').style.display='none'}

let chart;
function renderChart(u,m,l){
const ctx=document.getElementById('chart');
if(chart)chart.destroy();
chart=new Chart(ctx,{
type:'doughnut',
data:{labels:['Upper','Mid','Lower'],
datasets:[{data:[u,m,l],
backgroundColor:['#E50100','#008596','#0F172A']}]},
options:{plugins:{legend:{position:'bottom'}}}
});
}

</script>
</body>
</html>



